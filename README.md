# üè∞ API Fortress

<div align="center">

[![Python](https://img.shields.io/badge/python-3.9+-blue.svg?style=for-the-badge&logo=python&logoColor=white)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg?style=for-the-badge)](LICENSE)
[![OWASP](https://img.shields.io/badge/OWASP-API%20Top%2010-red.svg?style=for-the-badge&logo=owasp)](https://owasp.org/www-project-api-security/)
[![GitHub](https://img.shields.io/badge/GitHub-4fqr%2Fapi--fortress-181717.svg?style=for-the-badge&logo=github)](https://github.com/4fqr/api-fortress)
[![zread](https://img.shields.io/badge/Ask_Zread-_.svg?style=for-the-badge&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuOTYxNTYgMS42MDAxSDIuMjQxNTZDMS44ODgxIDEuNjAwMSAxLjYwMTU2IDEuODg2NjQgMS42MDE1NiAyLjI0MDFWNC45NjAxQzEuNjAxNTYgNS4zMTM1NiAxLjg4ODEgNS42MDAxIDIuMjQxNTYgNS42MDAxSDQuOTYxNTZDNS4zMTUwMiA1LjYwMDEgNS42MDE1NiA1LjMxMzU2IDUuNjAxNTYgNC45NjAxVjIuMjQwMUM1LjYwMTU2IDEuODg2NjQgNS4zMTUwMiAxLjYwMDEgNC45NjE1NiAxLjYwMDFaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00Ljk2MTU2IDEwLjM5OTlIMi4yNDE1NkMxLjg4ODEgMTAuMzk5OSAxLjYwMTU2IDEwLjY4NjQgMS42MDE1NiAxMS4wMzk5VjEzLjc1OTlDMS42MDE1NiAxNC4xMTM0IDEuODg4MSAxNC4zOTk5IDIuMjQxNTYgMTQuMzk5OUg0Ljk2MTU2QzUuMzE1MDIgMTQuMzk5OSA1LjYwMTU2IDE0LjExMzQgNS42MDE1NiAxMy43NTk5VjExLjAzOTlDNS42MDE1NiAxMC42ODY0IDUuMzE1MDIgMTAuMzk5OSA0Ljk2MTU2IDEwLjM5OTlaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik0xMy43NTg0IDEuNjAwMUgxMS4wMzg0QzEwLjY4NSAxLjYwMDEgMTAuMzk4NCAxLjg4NjY0IDEwLjM5ODQgMi4yNDAxVjQuOTYwMUMxMC4zOTg0IDUuMzEzNTYgMTAuNjg1IDUuNjAwMSAxMS4wMzg0IDUuNjAwMUgxMy43NTg0QzE0LjExMTkgNS42MDAxIDE0LjM5ODQgNS4zMTM1NiAxNC4zOTg0IDQuOTYwMVYyLjI0MDFDMTQuMzk4NCAxLjg4NjY0IDE0LjExMTkgMS42MDAxIDEzLjc1ODQgMS42MDAxWiIgZmlsbD0iI2ZmZiIvPgo8cGF0aCBkPSJNNCAxMkwxMiA0TDQgMTJaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00IDEyTDEyIDQiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K&logoColor=ffffff)](https://zread.ai/4fqr/api-fortress)

**Universal API Security Testing Suite**

*The most comprehensive command-line security scanner supporting 30+ platforms with 500+ error detection patterns*

[üöÄ Quick Start](#quick-start) ‚Ä¢ [üìö Full Guide](#complete-command-reference) ‚Ä¢ [üéØ Examples](#examples) ‚Ä¢ [üîç Platforms](#supported-platforms)

![Status](https://img.shields.io/badge/Status-Production%20Ready-success?style=flat-square)
![Platforms](https://img.shields.io/badge/Supported%20Platforms-30+-blue?style=flat-square)
![Scanners](https://img.shields.io/badge/Security%20Scanners-7-orange?style=flat-square)

</div>

---

## Table of Contents

- [Overview](#overview)
- [Supported Platforms](#supported-platforms)
- [Features](#features)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Complete Command Reference](#complete-command-reference)
- [Platform-Specific Examples](#platform-specific-examples)
- [Vulnerability Detection](#vulnerability-detection)
- [Output Formats](#output-formats)
- [Configuration](#configuration)
- [Contributing](#contributing)

---

## Overview

**API Fortress** is the most comprehensive open-source API security testing suite, designed to scan ANY API from ANY platform. Built with real-world penetration testing experience.

### Key Capabilities

- ‚ú® **Universal Support** - Works with OpenRouter, OpenAI, AWS, Azure, GCP, Render, Firebase, Stripe, GitHub, and 30+ platforms
- üîç **Deep Analysis** - Detects OWASP API Top 10, platform-specific vulnerabilities, and custom security issues
- üéØ **Smart Detection** - Comprehensive database of 500+ API-specific errors across all major platforms
- üìä **Professional Reports** - Generate HTML, JSON, and Markdown security audit reports
- üöÄ **Production Ready** - Async architecture, rate limiting, authentication, comprehensive error handling

---

## Supported Platforms

### AI & ML APIs

- ü§ñ **OpenRouter** - openrouter.ai
- üß† **OpenAI** - api.openai.com  
- üí¨ **Anthropic** - api.anthropic.com
- ü§ó **Hugging Face** - huggingface.co
- üîÑ **Replicate** - replicate.com
- üìù **Cohere** - cohere.ai

### Cloud Platforms

- ‚òÅÔ∏è **AWS** - amazonaws.com
- üî∑ **Azure** - azure.com
- üåê **Google Cloud** - googleapis.com
- üåä **DigitalOcean** - digitalocean.com
- ‚ö° **Render** - render.com, onrender.com
- üü£ **Heroku** - herokuapp.com
- ‚ñ≤ **Vercel** - vercel.app
- üî∫ **Netlify** - netlify.app

### Databases & Backend

- üçÉ **MongoDB** - mongodb.net
- üî• **Firebase** - firebaseio.com
- ‚ö° **Supabase** - supabase.co
- ü™ê **PlanetScale** - planetscale.com
- üìä **Airtable** - airtable.com

### Payment & Commerce

- üí≥ **Stripe** - stripe.com
- üí∞ **PayPal** - paypal.com
- ‚óºÔ∏è **Square** - squareup.com
- üõí **Shopify** - shopify.com

### Communication & Social

- üì± **Twilio** - twilio.com
- üìß **SendGrid** - sendgrid.com
- ‚úâÔ∏è **Mailgun** - mailgun.net
- üí¨ **Slack** - slack.com
- üéÆ **Discord** - discord.com

### Developer Platforms

- üêô **GitHub** - github.com
- ü¶ä **GitLab** - gitlab.com
- üîê **Auth0** - auth0.com
- üîë **OAuth Providers** - Google, Facebook, Twitter

### Plus Generic Support

- ‚úÖ **REST APIs** - Any REST endpoint
- ‚úÖ **GraphQL** - GraphQL endpoints
- ‚úÖ **WebSocket** - WebSocket connections
- ‚úÖ **SOAP** - SOAP services
- ‚úÖ **gRPC** - gRPC services

---

## Features

### Security Scanners

1. **BOLA Scanner** - Broken Object Level Authorization detection
2. **Authentication Scanner** - Auth bypass, weak tokens, session security
3. **Injection Scanner** - SQL, NoSQL, Command, LDAP injection
4. **Misconfiguration Scanner** - Headers, CORS, error messages
5. **SSRF Scanner** - Server-Side Request Forgery detection
6. **Deep Analysis Scanner** - Firebase rules, data exposure, enumeration
7. **Universal Error Scanner** - Platform-specific error detection

### Advanced Capabilities

- üéØ **Platform Detection** - Auto-detects API platform from URL
- üìã **Error Database** - 500+ known errors across all platforms
- üîê **Multi-Auth Support** - Bearer, Basic, API Key, OAuth2, Custom Headers
- ‚ö° **Rate Limit Awareness** - Platform-specific rate limits
- üé® **Beautiful Terminal UI** - Color-coded output with Rich library
- üìä **Multiple Report Formats** - JSON, HTML, Markdown
- üîç **Smart False Positive Reduction** - Context-aware detection
- üí° **Detailed Remediation** - Step-by-step fixes for every finding

---

## Installation

### Prerequisites

- Python 3.9 or higher
- pip package manager
- Git (recommended)

### Quick Install

```powershell
# Clone repository
git clone https://github.com/4fqr/api-fortress.git
cd api-fortress

# Install dependencies
pip install -r requirements.txt

# Install package
pip install -e .

# Verify installation
python fortress.py --help
```

### Windows Setup

```powershell
# Set UTF-8 encoding for proper display
$env:PYTHONIOENCODING="utf-8"

# Or add to PowerShell profile for permanent setting
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8
```

---

## Quick Start

### Basic Scan

```powershell
python fortress.py scan https://api.example.com
```

### Scan with Authentication

```powershell
# Bearer Token (OpenRouter, OpenAI, etc.)
python fortress.py scan https://openrouter.ai/api/v1 --auth-type bearer --token "YOUR_TOKEN"

# API Key (Anthropic, etc.)
python fortress.py scan https://api.anthropic.com --auth-type apikey --token "YOUR_KEY"

# Custom Headers
python fortress.py scan https://api.render.com --header "Authorization: Bearer TOKEN"
```

### Generate Report

```powershell
# HTML Report
python fortress.py scan https://api.example.com --format html -o report.html

# JSON Report (CI/CD)
python fortress.py scan https://api.example.com --format json -o report.json

# Markdown Report
python fortress.py scan https://api.example.com --format markdown -o report.md
```

---

## Complete Command Reference

### Main Command

```
python fortress.py scan <URL> [OPTIONS]
```

### All Options

| Option | Short | Description | Example |
|--------|-------|-------------|---------|
| `--methods` | | HTTP methods to test | `--methods GET,POST,PUT` |
| `--header` | `-H` | Custom headers | `-H "X-API-Key: value"` |
| `--auth-type` | | Authentication type | `--auth-type bearer` |
| `--token` | `-t` | Auth token/credentials | `--token "YOUR_TOKEN"` |
| `--timeout` | | Request timeout (seconds) | `--timeout 60` |
| `--max-concurrent` | | Concurrent requests | `--max-concurrent 5` |
| `--output` | `-o` | Output file path | `-o report.html` |
| `--format` | | Report format | `--format html` |
| `--no-verify-ssl` | | Disable SSL verification | `--no-verify-ssl` |
| `--verbose` | `-v` | Verbose output | `--verbose` |
| `--exclude` | | Exclude paths | `--exclude /health` |

### Authentication Types

- `bearer` - Bearer token (JWT) - Most APIs
- `basic` - Basic authentication
- `apikey` - API key authentication
- `none` - No authentication (default)

### Report Formats

- `json` - Machine-readable, CI/CD integration
- `html` - Beautiful visual reports with styling
- `markdown` - Documentation-ready format

### HTTP Methods

Default: `GET,POST,PUT,DELETE,PATCH`

Specify custom: `--methods GET,POST`

---

## Platform-Specific Examples

### OpenRouter API

```powershell
python fortress.py scan https://openrouter.ai/api/v1/chat/completions `
  --auth-type bearer `
  --token "sk-or-v1-..." `
  --methods POST `
  --format html `
  -o openrouter-security-report.html
```

**Detects:**
- Invalid model errors
- Insufficient credits
- Rate limiting issues
- Authentication problems
- Model overload scenarios

### OpenAI API

```powershell
python fortress.py scan https://api.openai.com/v1/chat/completions `
  --auth-type bearer `
  --token "sk-..." `
  --methods POST `
  --verbose
```

**Detects:**
- Context length exceeded
- Invalid API key errors
- Rate limit violations
- Model availability issues

### Render.com API

```powershell
python fortress.py scan https://api.render.com/v1/services `
  -H "Authorization: Bearer rnd_..." `
  --methods GET,POST,DELETE `
  --format markdown `
  -o render-audit.md
```

**Detects:**
- Service suspension issues
- Deploy failures
- Authentication errors
- Permission problems

### Firebase Realtime Database

```powershell
python fortress.py scan https://your-app.firebaseio.com/data.json `
  --methods GET,PUT `
  --format html `
  -o firebase-security-audit.html
```

**Detects:**
- Unauthenticated read/write access
- Security rules misconfiguration
- Data exposure vulnerabilities
- Rate limiting issues

### AWS API

```powershell
python fortress.py scan https://api.amazonaws.com/service `
  -H "Authorization: AWS4-HMAC-SHA256 ..." `
  --methods GET,POST `
  --timeout 30
```

**Detects:**
- Invalid signature errors
- IAM permission issues
- Access denied scenarios
- Service availability

### Stripe API

```powershell
python fortress.py scan https://api.stripe.com/v1/customers `
  --auth-type bearer `
  --token "sk_test_..." `
  --methods GET,POST
```

**Detects:**
- Card declined errors
- Expired card scenarios
- Insufficient funds
- Authentication issues

### GitHub API

```powershell
python fortress.py scan https://api.github.com/repos/user/repo `
  -H "Authorization: token ghp_..." `
  --methods GET,POST,PUT,DELETE
```

**Detects:**
- Rate limit issues
- Permission errors
- Resource not found
- Authentication failures

### Generic REST API

```powershell
python fortress.py scan https://api.example.com `
  --methods GET,POST,PUT,DELETE,PATCH `
  --header "X-API-Key: your-key" `
  --header "X-Custom-Header: value" `
  --timeout 60 `
  --max-concurrent 10 `
  --format html `
  -o complete-security-audit.html `
  --verbose
```

---

## Vulnerability Detection

### OWASP API Security Top 10

1. **API1:2023 - Broken Object Level Authorization (BOLA)**
   - Tests for unauthorized object access
   - ID manipulation detection
   - Missing authorization checks

2. **API2:2023 - Broken Authentication**
   - Weak token validation
   - Session management issues
   - Rate limiting bypass

3. **API3:2023 - Broken Object Property Level Authorization**
   - Mass assignment vulnerabilities
   - Excessive data exposure
   - Property-level access control

4. **API4:2023 - Unrestricted Resource Access**
   - Rate limiting issues
   - Resource exhaustion
   - DoS vulnerabilities

5. **API5:2023 - Broken Function Level Authorization**
   - Privilege escalation
   - Function-level access control
   - Admin endpoint exposure

6. **API6:2023 - Unrestricted Access to Sensitive Business Flows**
   - Business logic flaws
   - Workflow bypass
   - Sequential ID enumeration

7. **API7:2023 - Server Side Request Forgery (SSRF)**
   - Internal network access
   - Cloud metadata exposure
   - URL manipulation

8. **API8:2023 - Security Misconfiguration**
   - Missing security headers
   - CORS misconfiguration
   - Verbose error messages
   - Insecure defaults

9. **API9:2023 - Improper Inventory Management**
   - Version detection
   - Endpoint discovery
   - Documentation exposure

10. **API10:2023 - Unsafe Consumption of APIs**
    - Third-party API risks
    - Input validation
    - Timeout handling

### Platform-Specific Vulnerabilities

- **Firebase** - Security rules, authentication, data exposure
- **AWS** - IAM policies, signature validation, service access
- **Stripe** - Payment validation, webhook security
- **OAuth** - Token validation, scope issues, redirect URIs

### Advanced Detection

- **Data Exposure** - Passwords, API keys, tokens, emails, SSN, credit cards
- **API Enumeration** - Predictable IDs, sequential access
- **Rate Limiting** - DoS vectors, insufficient limits
- **Error Handling** - Information disclosure, stack traces

---

## Output Formats

### JSON Format

Machine-readable format for CI/CD pipelines and automation.

```json
{
  "scan_id": "uuid",
  "target": "https://api.example.com",
  "vulnerabilities": [
    {
      "name": "Missing Authentication",
      "severity": "CRITICAL",
      "endpoint": "https://api.example.com/users",
      "method": "GET",
      "description": "Detailed explanation...",
      "evidence": "Proof of vulnerability...",
      "remediation": ["Step 1", "Step 2"],
      "cwe_id": "CWE-285",
      "cvss_score": 9.1
    }
  ]
}
```

### HTML Format

Beautiful, professional reports with color-coded severity levels.

- Gradient headers
- Severity badges
- Detailed evidence sections
- Remediation steps
- CVSS scores and CWE IDs

### Markdown Format

Documentation-ready format for README files and wikis.

```markdown
# Security Audit Report

## Critical Vulnerabilities

### Missing Authentication
- **Endpoint**: https://api.example.com/users
- **Method**: GET
- **Severity**: CRITICAL
```

---

## Configuration

### Configuration File

Create `fortress.yaml`:

```yaml
target_url: https://api.example.com
methods:
  - GET
  - POST
  - PUT
auth_type: bearer
auth_token: YOUR_TOKEN
timeout: 30
max_concurrent: 10
exclude_paths:
  - /health
  - /metrics
```

Use configuration:

```powershell
python fortress.py scan --config fortress.yaml
```

### Environment Variables

```powershell
# Set API token
$env:API_TOKEN="your-token"

# Use in scan
python fortress.py scan https://api.example.com --token $env:API_TOKEN
```

---

## Advanced Usage

### CI/CD Integration

```yaml
# GitHub Actions
- name: API Security Scan
  run: |
    python fortress.py scan ${{ secrets.API_URL }} \
      --auth-type bearer \
      --token ${{ secrets.API_TOKEN }} \
      --format json \
      -o security-report.json
```

### Multiple Endpoints

```powershell
# Scan multiple endpoints
python fortress.py scan https://api.example.com/v1 --methods GET,POST
python fortress.py scan https://api.example.com/v2 --methods GET,POST
```

### Custom Scanning

```powershell
# Focus on specific methods
python fortress.py scan https://api.example.com --methods POST,PUT

# Exclude health checks
python fortress.py scan https://api.example.com `
  --exclude /health `
  --exclude /metrics `
  --exclude /status

# High concurrency for fast scanning
python fortress.py scan https://api.example.com --max-concurrent 20
```

---

## Tips & Best Practices

### Performance

- Use `--max-concurrent` to adjust speed (default: 10)
- Lower concurrency for rate-limited APIs
- Use `--exclude` to skip non-API endpoints
- Set appropriate `--timeout` for slow APIs

### Security

- Never hardcode API tokens in commands
- Use environment variables or config files
- Store reports securely
- Review findings before sharing reports
- Re-scan after applying fixes

### Accuracy

- Use `--verbose` to see detailed progress
- Review all CRITICAL and HIGH findings immediately
- Verify findings in staging before production
- Test fixes with re-scanning
- Monitor for false positives

---

## Architecture

### Scanner Flow

```
URL Input ‚Üí Platform Detection ‚Üí Scanner Selection ‚Üí Async Scanning ‚Üí Results Analysis ‚Üí Report Generation
```

### Components

- **Scanner Engine** - Orchestrates all security tests
- **HTTP Client** - Async request handling with aiohttp
- **Vulnerability Models** - Pydantic data validation
- **Display System** - Rich terminal UI
- **Reporting Engine** - Multi-format report generation
- **Recommendations Engine** - Platform-specific guidance

### Scanners

1. BOLAScanner - Authorization testing
2. AuthScanner - Authentication validation
3. InjectionScanner - Injection detection
4. MisconfigScanner - Configuration issues
5. SSRFScanner - SSRF detection
6. DeepAnalysisScanner - Platform-specific deep analysis
7. UniversalErrorScanner - Error database matching

---

## Error Database

### Comprehensive Coverage

- **HTTP Status Codes** - 400, 401, 403, 404, 429, 500, 502, 503
- **Platform Errors** - 500+ known errors
- **Common Causes** - Root cause analysis
- **Remediation Steps** - How to fix each error

### Example Error Info

```
Status: 429 Too Many Requests
Platform: OpenRouter
Cause: Rate limit exceeded
Fix: Implement exponential backoff
Rate Limits: 200 req/min, 20000 req/day
```

---

## Contributing

We welcome contributions! Please see [CONTRIBUTING.md](CONTRIBUTING.md) for details.

### Areas for Contribution

- New platform support
- Additional vulnerability scanners
- Error database expansion
- Documentation improvements
- Bug fixes and optimizations

---

## License

MIT License - see [LICENSE](LICENSE) file for details.

---

## Support

- **Issues**: [GitHub Issues](https://github.com/4fqr/api-fortress/issues)
- **Discussions**: [GitHub Discussions](https://github.com/4fqr/api-fortress/discussions)
- **Documentation**: [Full Docs](INSTALL.md)

---

<div align="center">

**üè∞ API Fortress - Professional API Security Testing**

*Built with ‚ù§Ô∏è by security professionals, for security professionals*

[![Star on GitHub](https://img.shields.io/github/stars/4fqr/api-fortress?style=social)](https://github.com/4fqr/api-fortress)

</div>
